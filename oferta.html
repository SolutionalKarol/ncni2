<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-56VR40VHHV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-56VR40VHHV');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pe≈Çna Oferta i Cennik | NCNI Wroc≈Çaw</title>
    <meta name="description" content="Kompleksowa oferta NCNI: Diagnoza ADHD/ASD, Terapia VR, Biofeedback, Psychotraumatologia, Dietetyka. Sprawd≈∫ zakres us≈Çug i cennik.">
    <link rel="icon" href="logo.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
     <!-- GA4 -->
 <script async src="https://www.googletagmanager.com/gtag/js?id=G-56VR40VHHV"></script>
 <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-56VR40VHHV');
 </script>

    <style>
        :root {
            /* Palette - Clinical & Professional (Sp√≥jna z Indexem) */
            --bg-body: #F8FAFC;       
            --bg-surface: rgba(255, 255, 255, 0.85);
            --primary: #0F766E;       
            --primary-dark: #0D5E57;
            --primary-light: #CCFBF1;
            --accent: #6366F1;        
            --text-main: #1E293B;
            --text-muted: #64748B;
            --border: #E2E8F0;
            --radius: 16px;
            --trans-default: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-body); color: var(--text-main); line-height: 1.6; overflow-x: hidden; }
        h1, h2, h3 { font-family: 'Lexend', sans-serif; }
        
        #bg-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: -1; opacity: 0.6; pointer-events: none; }
        .container { max-width: 900px; margin: 0 auto; padding: 0 24px; }
        .glass { background: var(--bg-surface); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.6); box-shadow: 0 4px 20px rgba(0,0,0,0.03); }
        
        /* Cursor (Desktop Only) */
        @media (min-width: 1025px) {
            body, a, button, summary { cursor: none !important; }
            .cursor-dot { width: 8px; height: 8px; background: var(--primary); position: fixed; top: 0; left: 0; transform: translate(-50%, -50%); border-radius: 50%; z-index: 9999; pointer-events: none; }
            .cursor-outline { width: 40px; height: 40px; border: 1px solid rgba(15, 118, 110, 0.5); position: fixed; top: 0; left: 0; transform: translate(-50%, -50%); border-radius: 50%; z-index: 9998; pointer-events: none; transition: width 0.2s, height 0.2s, background-color 0.2s, border-color 0.2s; }
            body.hovering .cursor-outline { width: 70px; height: 70px; background-color: rgba(15, 118, 110, 0.05); border-color: var(--primary); border-width: 2px; }
        }
        @media (max-width: 1024px) {
            .cursor-dot, .cursor-outline { display: none !important; }
            body { cursor: auto; }
        }

        /* Header */
        header { position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid var(--border); padding: 12px 0; }
        .nav-wrapper { display: flex; flex-direction: column; align-items: center; gap: 16px; }
        .brand-bar { display: flex; justify-content: center; align-items: center; width: 100%; position: relative; }
        .logo { display: flex; align-items: center; gap: 14px; font-weight: 700; font-size: 1.6rem; color: var(--text-main); text-decoration: none; cursor: pointer; letter-spacing: -0.02em; }
        .logo img { height: 50px; width: auto; border-radius: 8px; }
        .nav-links { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .nav-item { padding: 8px 18px; border-radius: 99px; font-size: 0.95rem; font-weight: 500; color: var(--text-muted); text-decoration: none; transition: var(--trans-default); cursor: pointer; }
        .nav-item:hover, .nav-item.active { color: var(--primary); background: var(--primary-light); }
        .nav-cta { background: var(--primary); color: white !important; box-shadow: 0 4px 12px rgba(15, 118, 110, 0.25); margin-left: 8px; }
        .nav-cta:hover { background: var(--primary-dark); transform: translateY(-1px); }
        
        /* Mobile Toggle */
        .mobile-toggle { display: none; background: none; border: none; cursor: pointer; padding: 8px; position: absolute; right: 0; top: 50%; transform: translateY(-50%); }
        .mobile-toggle span { display: block; width: 24px; height: 2px; background: var(--text-main); margin: 5px 0; transition: 0.3s; }
        .mobile-menu { position: fixed; top: 80px; left: 0; width: 100%; background: white; padding: 24px; border-bottom: 1px solid var(--border); transform: translateY(-150%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1); z-index: 999; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .mobile-menu.active { transform: translateY(0); }
        .mobile-link { display: block; padding: 14px 0; font-size: 1.1rem; font-weight: 500; color: var(--text-main); text-decoration: none; border-bottom: 1px solid var(--bg-body); }

        @media (max-width: 900px) {
            .nav-wrapper { flex-direction: row; height: 60px; justify-content: space-between; padding: 0; }
            .brand-bar { justify-content: flex-start; width: auto; }
            .nav-links { display: none; }
            .mobile-toggle { display: block; }
            .logo { font-size: 1.1rem; }
            .logo img { height: 36px; }
        }

        /* --- Offer List Style --- */
        .offer-list { margin-top: 40px; }
        
        .category-header {
            font-size: 1.8rem;
            color: var(--text-main);
            margin: 60px 0 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .category-header span { color: var(--primary); font-family: 'Lexend', sans-serif; }

        /* Accordion */
        details {
            margin-bottom: 16px; border: 1px solid var(--border); border-radius: 16px;
            background: white; overflow: hidden; transition: all 0.3s ease;
        }
        details:hover { border-color: var(--primary-light); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        details[open] { border-color: var(--primary); box-shadow: 0 4px 12px rgba(15, 118, 110, 0.1); }
        
        summary {
            padding: 24px; cursor: pointer; font-weight: 600; font-size: 1.1rem;
            display: flex; justify-content: space-between; align-items: center; list-style: none;
            color: var(--text-main); background: white;
        }
        summary::-webkit-details-marker { display: none; }
        summary::after {
            content: '+'; font-size: 1.5rem; color: var(--primary); transition: transform 0.2s; font-weight: 300;
        }
        details[open] summary::after { transform: rotate(45deg); }
        details[open] summary { border-bottom: 1px solid var(--bg-body); background: #F0FDF4; }
        
        .details-content { padding: 32px; color: var(--text-muted); background: white; }
        .details-content p { margin-bottom: 16px; }
        .details-content ul { padding-left: 20px; margin-bottom: 20px; }
        .details-content li { margin-bottom: 8px; }

        .btn-small {
            display: inline-block; padding: 10px 20px; background: var(--primary); color: white;
            border-radius: 99px; text-decoration: none; font-size: 0.9rem; font-weight: 600;
            margin-top: 8px; transition: 0.2s; box-shadow: 0 4px 6px rgba(15, 118, 110, 0.2);
            cursor: pointer;
        }
        .btn-small:hover { background: #0D9488; transform: translateY(-2px); }

        /* Footer */
        footer { background: white; border-top: 1px solid var(--border); padding: 60px 0 20px; margin-top: 80px; text-align: center; }
    </style>
</head>
<body>

    <div id="bg-canvas"></div>
    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>

    <header class="glass">
        <div class="container nav-wrapper">
            <div class="brand-bar">
                <a href="index.html" class="logo cursor-trigger">
                    <img src="logo.png" alt="NCNI">
                    <span>Naukowe Centrum Neuroinnowacji</span>
                </a>
                <button class="mobile-toggle cursor-trigger" aria-label="Menu">
                    <span></span><span></span><span></span>
                </button>
            </div>
            <nav class="nav-links">
                <a href="o-nas.html" class="nav-item cursor-trigger">O nas</a>
                <a href="neuroroznorodnosc.html" class="nav-item cursor-trigger">Neuror√≥≈ºnorodno≈õƒá</a>
                <a href="psychologia.html" class="nav-item cursor-trigger">Psychologia</a>
                <a href="technologie.html" class="nav-item cursor-trigger">Technologie</a>
                <a href="oferta.html" class="nav-item cursor-trigger active">Oferta</a>
                <a href="index.html#rezerwacja" class="nav-item nav-cta cursor-trigger">Um√≥w wizytƒô</a>
            </nav>
        </div>
    </header>

    <div class="mobile-menu">
        <a href="o-nas.html" class="mobile-link">O nas</a>
        <a href="neuroroznorodnosc.html" class="mobile-link">Neuror√≥≈ºnorodno≈õƒá</a>
        <a href="psychologia.html" class="mobile-link">Psychologia</a>
        <a href="technologie.html" class="mobile-link">Technologie</a>
        <a href="oferta.html" class="mobile-link">Pe≈Çna Oferta</a>
        <a href="index.html#rezerwacja" class="mobile-link" style="color: var(--primary); font-weight: 700;">Um√≥w wizytƒô</a>
    </div>

    <section class="container" style="padding: 80px 24px;">
        <div style="text-align: center; margin-bottom: 40px;">
            <span style="background: var(--primary-light); color: var(--primary); padding: 6px 12px; border-radius: 99px; font-size: 0.9rem; font-weight: 600;">Standard Kliniczny</span>
            <h1 style="font-size: 3rem; margin-top: 16px;">Oferta NCNI</h1>
            <p style="color: var(--text-muted); font-size: 1.2rem; margin-top: 16px; max-width: 700px; margin-left: auto; margin-right: auto;">
                Scentralizowany katalog us≈Çug medycznych i terapeutycznych. Od diagnostyki, przez terapiƒô psychologicznƒÖ, a≈º po Neuro-Immersjƒô Premium.
            </p>
        </div>

        <div class="offer-list">
            
            <h2 class="category-header"><span>01.</span> Psychologia & Psychotraumatologia</h2>

            <details class="cursor-trigger">
                <summary>Psychoterapia Indywidualna</summary>
                <div class="details-content">
                    <p>Indywidualne sesje terapeutyczne dla os√≥b doros≈Çych zmagajƒÖcych siƒô z kryzysem, depresjƒÖ, lƒôkiem lub trudno≈õciami ≈ºyciowymi.</p>
                    <a href="psychologia.html" class="btn-small">Wiƒôcej o psychoterapii</a>
                </div>
            </details>

            <details class="cursor-trigger">
                <summary>Psychoterapia Traumy (EMDR / SE)</summary>
                <div class="details-content">
                    <p>Specjalistyczna praca z traumƒÖ (PTSD, trauma z≈Ço≈ºona) z wykorzystaniem metod przetwarzania pamiƒôci i pracy z cia≈Çem (Somatic Experiencing).</p>
                    <a href="psychologia.html" class="btn-small">O leczeniu traumy</a>
                </div>
            </details>

            <details class="cursor-trigger">
                <summary>Psychoterapia Par</summary>
                <div class="details-content">
                    <p>Wsparcie dla zwiƒÖzk√≥w w kryzysie. Praca nad komunikacjƒÖ, blisko≈õciƒÖ i rozwiƒÖzywaniem konflikt√≥w.</p>
                </div>
            </details>

            <h2 class="category-header" style="border-bottom-color: var(--accent);"><span>02.</span> Diagnostyka Kliniczna</h2>
            
            <details class="cursor-trigger">
                <summary>Diagnoza ADHD (Doro≈õli i Dzieci)</summary>
                <div class="details-content">
                    <p>Kompleksowy proces diagnostyczny (3-4 spotkania). Obejmuje wywiad kliniczny (DIVA-5), testy komputerowe (MOXO) i obserwacjƒô. Pe≈Çny raport z zaleceniami.</p>
                    <a href="adhd.html" class="btn-small">Wiƒôcej o diagnozie ADHD</a>
                </div>
            </details>

            <details class="cursor-trigger">
                <summary>Diagnoza Spektrum Autyzmu (ASD)</summary>
                <div class="details-content">
                    <p>Wielospecjalistyczna diagnoza z udzia≈Çem psychologa i psychiatry. Wykorzystujemy z≈Çoty standard diagnostyczny ADOS-2.</p>
                    <a href="asd.html" class="btn-small">Szczeg√≥≈Çy diagnozy ASD</a>
                </div>
            </details>

            <h2 class="category-header" style="border-bottom-color: #10B981;"><span>03.</span> Neuro-Technologie & VR</h2>

            <details class="cursor-trigger">
                <summary>Neuro-Immersja Kliniczna (VR + Zero-G + Biofeedback)</summary>
                <div class="details-content">
                    <p><strong>Hiper-Premium:</strong> Zaawansowana procedura regulacji uk≈Çadu nerwowego. ≈ÅƒÖczy ca≈Çkowite odciƒÖ≈ºenie krƒôgos≈Çupa (Zero-G), terapiƒô wirtualnƒÖ i monitoring pracy serca. Najg≈Çƒôbszy reset dostƒôpny we Wroc≈Çawiu.</p>
                    <a href="index.html#rezerwacja" class="btn-small">Um√≥w Neuro-Immersjƒô</a>
                </div>
            </details>

            <details class="cursor-trigger">
                <summary>Terapia VR (Fobie i Lƒôki)</summary>
                <div class="details-content">
                    <p>Terapia ekspozycyjna w wirtualnym ≈õrodowisku. Leczenie fobii (lƒôk wysoko≈õci, pajƒÖki, samoloty), lƒôku spo≈Çecznego i wystƒÖpie≈Ñ publicznych.</p>
                    <a href="technologie.html" class="btn-small">Zobacz laboratorium VR</a>
                </div>
            </details>

            <details class="cursor-trigger">
                <summary>Biofeedback HRV</summary>
                <div class="details-content">
                    <p>Trening koherencji serca. Nauka ≈õwiadomej redukcji stresu poprzez oddech, z podglƒÖdem parametr√≥w fizjologicznych na ≈ºywo.</p>
                </div>
            </details>

            <h2 class="category-header" style="border-bottom-color: #F59E0B;"><span>04.</span> Wsparcie Holistyczne (Cia≈Ço & Dieta)</h2>

            <details class="cursor-trigger">
                <summary>Dietetyka Kliniczna</summary>
                <div class="details-content">
                    <p>Wsparcie ≈ºywieniowe w zaburzeniach nastroju, ADHD i spektrum autyzmu. Praca z osiƒÖ jelito-m√≥zg.</p>
                    <a href="dietetyk.html" class="btn-small">Profil Dietetyka</a>
                </div>
            </details>

            <details class="cursor-trigger">
                <summary>Fizjoterapia Somatyczna</summary>
                <div class="details-content">
                    <p>Praca z napiƒôciami w ciele wynikajƒÖcymi z przewlek≈Çego stresu i traumy. Uwalnianie blokad miƒô≈õniowych.</p>
                    <a href="fizjoterapia.html" class="btn-small">Profil Fizjoterapeuty</a>
                </div>
            </details>

        </div>
    </section>

    <footer>
        <div class="container" style="color: var(--text-muted);">
            &copy; 2025 Naukowe Centrum Neuroinnowacji.
        </div>
    </footer>

    <div id="ncni-widget-container" style="font-family: 'Inter', sans-serif; z-index: 9999; position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; align-items: flex-end;">
    
        <button id="ncni-toggle-btn" style="background: #0F766E; border: none; width: 60px; height: 60px; border-radius: 50%; box-shadow: 0 10px 25px rgba(15, 118, 110, 0.4); cursor: pointer; transition: transform 0.2s; display: flex; align-items: center; justify-content: center;">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 6C13.66 6 15 7.34 15 9C15 10.66 13.66 12 12 12C10.34 12 9 10.66 9 9C9 7.34 10.34 6 12 6ZM12 20C9.33 20 7 18 7 15C7 14 9.33 12 12 12C14.67 12 17 14 17 15C17 18 14.67 20 12 20Z" fill="#ffffff"/>
            </svg>
        </button>
      
        <div id="ncni-chat-window" style="display: none; width: 350px; height: 500px; background: rgba(255, 255, 255, 0.98); border: 1px solid #E2E8F0; border-radius: 18px; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.2); margin-bottom: 16px; flex-direction: column;">
            
            <div style="background: #0F766E; padding: 15px; color: white; display: flex; align-items: center; justify-content: space-between;">
                <div style="font-weight: 600; font-size: 14px;">Asystent Kliniczny NCNI</div>
                <button id="ncni-close-btn" style="background:none; border:none; color: white; cursor: pointer; font-size: 18px;">&times;</button>
            </div>
      
            <div id="ncni-messages" style="flex: 1; padding: 15px; overflow-y: auto; color: #1E293B; font-size: 13px; display: flex; flex-direction: column; gap: 10px; background: #F8FAFC;">
                <div style="background: white; border: 1px solid #E2E8F0; padding: 10px 14px; border-radius: 12px 12px 12px 2px; align-self: flex-start; max-width: 85%; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                    Dzie≈Ñ dobry. Jestem wirtualnym asystentem NCNI. Pomogƒô dobraƒá ≈õcie≈ºkƒô diagnostycznƒÖ lub terapeutycznƒÖ (stres, ADHD, trauma). W czym mogƒô pom√≥c?
                </div>
            </div>
      
            <div style="padding: 15px; border-top: 1px solid #E2E8F0; display: flex; gap: 8px; background: white;">
                <input id="ncni-input" type="text" placeholder="Np. szukam diagnozy ADHD..." style="flex: 1; background: #F1F5F9; border: 1px solid #CBD5E1; border-radius: 99px; padding: 10px 16px; color: #334155; font-size: 13px; outline: none;">
                <button id="ncni-send-btn" style="background: #0F766E; color: white; border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">&uarr;</button>
            </div>
        </div>
      </div>
      
      <script>
      (function() {
        const API_KEY = "TU_WKLEJ_SWOJ_KLUCZ_API"; 
        
        // Zaktualizowana "Medyczna" Instrukcja
        const SYSTEM_INSTRUCTION = `
        Jeste≈õ asystentem klinicznym w NCNI (Naukowe Centrum Neuroinnowacji) we Wroc≈Çawiu.
        Tw√≥j styl komunikacji: Profesjonalny, empatyczny, konkretny, medyczny (EBM - Evidence Based Medicine).
        Unikaj marketingowego ≈ºargonu typu "magiczna podr√≥≈º". U≈ºywaj termin√≥w: "regulacja uk≈Çadu nerwowego", "neuroplastyczno≈õƒá", "trening funkcji wykonawczych".
      
        OFERTA KLINICZNA (Na podstawie strony NCNI):
      
        1. DIAGNOSTYKA (Standard Medyczny):
           - Diagnoza ADHD (Doro≈õli/Dzieci): Wywiad kliniczny (DIVA-5), testy komputerowe (MOXO), obserwacja, raport ko≈Ñcowy.
           - Diagnoza Spektrum Autyzmu (ASD): Z≈Çoty standard ADOS-2, zesp√≥≈Ç psycholog + psychiatra.
      
        2. NEURO-IMMERSJA KLINICZNA (To jest to "Hyper Premium" rozwiƒÖzanie):
           - Co to jest: Zaawansowana procedura regulacji uk≈Çadu nerwowego ≈ÇƒÖczƒÖca trzy technologie w jednym czasie.
           - Sk≈Çadniki: Fotel Zero-Gravity (ca≈Çkowite odciƒÖ≈ºenie krƒôgos≈Çupa i uk≈Çadu ruchu) + Terapia VR (kontrolowana immersja wizualna) + Biofeedback HRV (monitoring fizjologiczny na ≈ºywo).
           - Cel: G≈Çƒôboka redukcja kortyzolu, "reset" przebod≈∫cowania, trening koherencji serca.
           - Dla kogo: Przewlek≈Çy stres, stany lƒôkowe, wysokie napiƒôcie miƒô≈õniowe, potrzeba szybkiej regeneracji (np. kadra zarzƒÖdzajƒÖca).
           - Nazwa w systemie: "Protok√≥≈Ç Neuro-Immersji Zintegrowanej".
      
        3. TERAPIE SPECJALISTYCZNE:
           - Psychotraumatologia: Praca z traumƒÖ (EMDR, Somatic Experiencing).
           - Treningi ADHD/ASD: Trening funkcji wykonawczych, TUS (Trening Umiejƒôtno≈õci Spo≈Çecznych) w VR.
           - Fizjoterapia Somatyczna: Praca z napiƒôciami psychosomatycznymi w ciele.
           - Dietetyka Kliniczna: O≈õ jelito-m√≥zg (wsparcie w ADHD/ASD/Depresji).
      
        ZASADY:
        - Je≈õli klient pyta o relaks, proponuj "Protok√≥≈Ç Neuro-Immersji" jako najbardziej zaawansowanƒÖ formƒô regeneracji.
        - Je≈õli klient pyta o diagnozƒô, kieruj na ≈õcie≈ºkƒô diagnostycznƒÖ (ADHD/ASD).
        - Kontakt i adres: ul. ≈ªeromskiego 60/5a, Wroc≈Çaw. Tel: 600 608 333.
        `;
      
        const toggleBtn = document.getElementById('ncni-toggle-btn');
        const chatWindow = document.getElementById('ncni-chat-window');
        const closeBtn = document.getElementById('ncni-close-btn');
        const sendBtn = document.getElementById('ncni-send-btn');
        const input = document.getElementById('ncni-input');
        const messages = document.getElementById('ncni-messages');
      
        let isOpen = false;
      
        toggleBtn.addEventListener('click', () => {
            isOpen = !isOpen;
            chatWindow.style.display = isOpen ? 'flex' : 'none';
            if(isOpen) input.focus();
        });
        closeBtn.addEventListener('click', () => {
            isOpen = false;
            chatWindow.style.display = 'none';
        });
      
        function addMessage(text, isUser) {
            const msg = document.createElement('div');
            msg.style.padding = '10px 14px';
            msg.style.maxWidth = '85%';
            msg.style.borderRadius = isUser ? '12px 12px 2px 12px' : '12px 12px 12px 2px';
            msg.style.background = isUser ? '#0F766E' : 'white';
            msg.style.color = isUser ? 'white' : '#1E293B';
            msg.style.border = isUser ? 'none' : '1px solid #E2E8F0';
            msg.style.boxShadow = isUser ? '0 4px 6px rgba(15, 118, 110, 0.2)' : '0 2px 4px rgba(0,0,0,0.05)';
            msg.style.alignSelf = isUser ? 'flex-end' : 'flex-start';
            msg.innerText = text;
            messages.appendChild(msg);
            messages.scrollTop = messages.scrollHeight;
        }
      
        async function chatWithGemini(userText) {
            addMessage(userText, true);
            input.value = '';
            input.disabled = true;
            
            const loading = document.createElement('div');
            loading.innerText = 'Analizujƒô zapytanie...';
            loading.style.fontSize = '11px';
            loading.style.color = '#94a3b8';
            loading.style.marginLeft = '10px';
            messages.appendChild(loading);
      
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [
                            { role: "user", parts: [{ text: SYSTEM_INSTRUCTION + "\n\nKlient pyta: " + userText }] }
                        ]
                    })
                });
                
                const data = await response.json();
                messages.removeChild(loading);
      
                if(data.candidates && data.candidates[0].content) {
                    const aiText = data.candidates[0].content.parts[0].text;
                    addMessage(aiText, false);
                } else {
                    addMessage("B≈ÇƒÖd systemu AI. Spr√≥buj ponownie.", false);
                }
      
            } catch (e) {
                messages.removeChild(loading);
                addMessage("Problem z po≈ÇƒÖczeniem.", false);
            }
            input.disabled = false;
            input.focus();
        }
      
        sendBtn.addEventListener('click', () => { if(input.value.trim()) chatWithGemini(input.value); });
        input.addEventListener('keypress', (e) => { if(e.key === 'Enter' && input.value.trim()) chatWithGemini(input.value); });
      
      })();
      </script>

    <script>
        function initParticles() {
            const container = document.getElementById('bg-canvas');
            if (!container) return;
            const scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0xF8FAFC, 0.002);
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 10;
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            container.appendChild(renderer.domElement);
            const geometry = new THREE.BufferGeometry();
            const count = 200; 
            const positions = new Float32Array(count * 3);
            const colors = new Float32Array(count * 3);
            for(let i = 0; i < count * 3; i+=3) {
                positions[i] = (Math.random() - 0.5) * 25;
                positions[i+1] = (Math.random() - 0.5) * 25;
                positions[i+2] = (Math.random() - 0.5) * 25;
                const mix = Math.random();
                if(mix > 0.5) { colors[i] = 0.06; colors[i+1] = 0.46; colors[i+2] = 0.43; } 
                else { colors[i] = 0.39; colors[i+1] = 0.4; colors[i+2] = 0.94; }
            }
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            const material = new THREE.PointsMaterial({ size: 0.1, vertexColors: true, transparent: true, opacity: 0.4 });
            const particles = new THREE.Points(geometry, material);
            scene.add(particles);
            const clock = new THREE.Clock();
            function animate() {
                const time = clock.getElapsedTime();
                const scale = 1 + Math.sin(time * 0.5) * 0.02; 
                particles.scale.set(scale, scale, scale);
                particles.rotation.y += 0.001;
                renderer.render(scene, camera);
                requestAnimationFrame(animate);
            }
            animate();
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }
        document.addEventListener("DOMContentLoaded", initParticles);

        // Custom Cursor
        const cursorDot = document.querySelector('.cursor-dot');
        const cursorOutline = document.querySelector('.cursor-outline');
        window.addEventListener('mousemove', (e) => {
            const posX = e.clientX; const posY = e.clientY;
            cursorDot.style.left = `${posX}px`; cursorDot.style.top = `${posY}px`;
            cursorOutline.animate({ left: `${posX}px`, top: `${posY}px` }, { duration: 500, fill: "forwards" });
        });
        const triggers = document.querySelectorAll('.cursor-trigger, a, button, summary, .btn-small');
        triggers.forEach(trigger => {
            trigger.addEventListener('mouseenter', () => { document.body.classList.add('hovering'); });
            trigger.addEventListener('mouseleave', () => { document.body.classList.remove('hovering'); });
        });

        // Mobile Menu
        const toggle = document.querySelector('.mobile-toggle');
        const menu = document.querySelector('.mobile-menu');
        if (toggle && menu) {
            toggle.addEventListener('click', () => {
                menu.classList.toggle('active');
            });
            menu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => menu.classList.remove('active'));
            });
        }
    </script>
    <div id="ania-widget" class="ania-container">
        
        <div class="ania-bubble" id="ania-greeting">
            Dzie≈Ñ dobry! ‚òÄÔ∏è Jestem WirtualnƒÖ AsystentkƒÖ NCNI. Kliknij we mnie, a odpowiem na Twoje pytania.
            <span class="ania-close-bubble" onclick="closeGreeting(event)">‚úï</span>
        </div>

        <div class="ania-chat-window glass" id="ania-window">
            <div class="ania-header">
                <div style="display:flex; align-items:center; gap:10px;">
                    <div style="position:relative;">
                        <img src="ania.jpg" alt="Ania" style="width:35px; height:35px; border-radius:50%; object-fit:cover; object-position: top;">
                        <div class="status-dot-small"></div>
                    </div>
                    <div>
                        <strong style="display:block; line-height:1.1;">Ania NCNI</strong>
                        <span style="font-size: 0.75rem; color: var(--primary);">Wirtualny Asystent</span>
                    </div>
                </div>
                <button onclick="toggleAnia()" style="background:none; border:none; cursor:pointer; font-size:1.2rem; color: var(--text-muted);">‚úï</button>
            </div>

            <div class="ania-messages" id="ania-messages-area"></div>
            <div class="ania-options-area" id="ania-options-area"></div>
        </div>

        <div class="ania-avatar cursor-trigger" onclick="toggleAnia()">
            <img src="ania.jpg" alt="Ania Chat">
            <div class="status-dot"></div>
        </div>
    </div>

    <style>
        .ania-container { position: fixed; bottom: 24px; right: 24px; z-index: 2000; display: flex; flex-direction: column; align-items: flex-end; font-family: 'Inter', sans-serif; }
        .ania-avatar { width: 65px; height: 65px; border-radius: 50%; border: 3px solid white; box-shadow: 0 4px 20px rgba(15, 118, 110, 0.3); cursor: pointer; position: relative; transition: transform 0.3s; background: #fff; overflow: hidden; }
        .ania-avatar:hover { transform: scale(1.1); }
        .ania-avatar img { width: 100%; height: 100%; object-fit: cover; object-position: top; }
        .status-dot { width: 14px; height: 14px; background: #10B981; border: 2px solid white; border-radius: 50%; position: absolute; bottom: 4px; right: 4px; animation: pulse-dot 2s infinite; }
        .status-dot-small { width: 10px; height: 10px; background: #10B981; border: 1.5px solid white; border-radius: 50%; position: absolute; bottom: 0; right: 0; }
        @keyframes pulse-dot { 0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); } 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); } }
        .ania-bubble { background: white; padding: 12px 16px; border-radius: 12px 12px 0 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 12px; font-size: 0.9rem; color: var(--text-main); font-weight: 500; max-width: 260px; position: relative; opacity: 0; transform: translateY(10px); transition: all 0.4s ease; pointer-events: none; }
        .ania-bubble.visible { opacity: 1; transform: translateY(0); pointer-events: all; }
        .ania-close-bubble { position: absolute; top: -8px; right: -8px; background: #eee; width: 20px; height: 20px; border-radius: 50%; font-size: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; color: #666; }
        .ania-chat-window { position: absolute; bottom: 80px; right: 0; width: 360px; height: 500px; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); display: flex; flex-direction: column; overflow: hidden; opacity: 0; transform: translateY(20px) scale(0.95); pointer-events: none; transition: all 0.3s; border: 1px solid var(--border); }
        .ania-chat-window.active { opacity: 1; transform: translateY(0) scale(1); pointer-events: all; }
        .ania-header { background: #F8FAFC; padding: 16px; border-bottom: 1px solid #E2E8F0; display: flex; justify-content: space-between; align-items: center; }
        .ania-messages { flex: 1; padding: 16px; overflow-y: auto; background: #fff; display: flex; flex-direction: column; gap: 12px; }
        .msg { padding: 10px 14px; border-radius: 12px; font-size: 0.9rem; line-height: 1.5; max-width: 85%; animation: popIn 0.3s ease; }
        .msg.bot { background: #F1F5F9; color: var(--text-main); border-bottom-left-radius: 2px; align-self: flex-start; }
        .msg.user { background: var(--primary); color: white; border-bottom-right-radius: 2px; align-self: flex-end; }
        .ania-options-area { padding: 12px; background: #F8FAFC; border-top: 1px solid #E2E8F0; display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-end; }
        .chat-btn { background: white; border: 1px solid var(--primary); color: var(--primary); padding: 8px 14px; border-radius: 99px; font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .chat-btn:hover { background: var(--primary); color: white; }
        @keyframes popIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 480px) { .ania-chat-window { width: 300px; right: -10px; height: 450px; } }
    </style>

    <script>
        const chatKnowledge = {
            'start': { text: "Cze≈õƒá! üëã W czym mogƒô Ci pom√≥c?", options: [{ label: "üß† ADHD / ADD", next: 'adhd_info' }, { label: "üß© Autyzm (ASD)", next: 'asd_info' }, { label: "üí∞ Cennik / Oferta", next: 'oferta' }, { label: "üìÖ Um√≥w wizytƒô", action: 'booking' }] },
            'adhd_info': { text: "Oferujemy pe≈ÇnƒÖ diagnozƒô (DIVA-5, MOXO) oraz treningi VR i Biofeedback.", options: [{ label: "Jak wyglƒÖda diagnoza?", next: 'adhd_diagnoza' }, { label: "Na czym polega terapia?", next: 'adhd_terapia' }, { label: "Wr√≥ƒá", next: 'start' }] },
            'adhd_diagnoza': { text: "1. Wywiad kliniczny (DIVA-5).\n2. Test MOXO.\n3. Raport ko≈Ñcowy.", options: [{ label: "Chcƒô siƒô zapisaƒá", action: 'booking' }, { label: "Co to jest MOXO?", next: 'moxo' }] },
            'moxo': { text: "MOXO to komputerowy test badajƒÖcy uwagƒô, czas reakcji i impulsywno≈õƒá.", options: [{ label: "Rozumiem", next: 'start' }, { label: "Um√≥w badanie", action: 'booking' }] },
            'adhd_terapia': { text: "Wykorzystujemy VR (WirtualnƒÖ Rzeczywisto≈õƒá) i Biofeedback HRV do treningu skupienia.", options: [{ label: "Zapisz mnie", action: 'booking' }, { label: "Wr√≥ƒá", next: 'start' }] },
            'asd_info': { text: "Jeste≈õmy miejscem przyjaznym osobom w spektrum (Neurodiversity Affirming).", options: [{ label: "Um√≥w konsultacjƒô", action: 'booking' }, { label: "Wr√≥ƒá", next: 'start' }] },
            'oferta': { text: "Oferujemy diagnozƒô, psychoterapiƒô, VR, Biofeedback i dietetykƒô.", options: [{ label: "Adres?", next: 'adres' }, { label: "Um√≥w wizytƒô", action: 'booking' }] },
            'adres': { text: "Wroc≈Çaw, ul. Stefana ≈ªeromskiego 60/5a.", options: [{ label: "Dziƒôki!", next: 'start' }] }
        };

        const chatWindow = document.getElementById('ania-window');
        const messagesArea = document.getElementById('ania-messages-area');
        const optionsArea = document.getElementById('ania-options-area');
        const bubble = document.getElementById('ania-greeting');
        let isChatOpen = false;

        function toggleAnia() {
            isChatOpen = !isChatOpen;
            chatWindow.classList.toggle('active', isChatOpen);
            bubble.classList.remove('visible');
            if(isChatOpen && messagesArea.children.length === 0) loadScenario('start');
        }
        function closeGreeting(e) { e.stopPropagation(); bubble.classList.remove('visible'); }
        setTimeout(() => { if(!isChatOpen) bubble.classList.add('visible'); }, 3000);

        function addMessage(text, sender) {
            const div = document.createElement('div'); div.classList.add('msg', sender);
            div.innerHTML = text.replace(/\n/g, '<br>');
            messagesArea.appendChild(div); messagesArea.scrollTop = messagesArea.scrollHeight;
        }
        function loadScenario(key) {
            const data = chatKnowledge[key]; if(!data) return;
            showTypingIndicator();
            setTimeout(() => { removeTypingIndicator(); addMessage(data.text, 'bot'); renderOptions(data.options); }, 600);
        }
        function renderOptions(options) {
            optionsArea.innerHTML = '';
            if(!options) return;
            options.forEach(opt => {
                const btn = document.createElement('button'); btn.classList.add('chat-btn'); btn.innerText = opt.label;
                btn.onclick = () => handleUserChoice(opt); optionsArea.appendChild(btn);
            });
        }
        function handleUserChoice(opt) {
            addMessage(opt.label, 'user'); optionsArea.innerHTML = '';
            if (opt.action === 'booking') {
                window.location.href = 'index.html#rezerwacja';
                if(window.innerWidth < 480) toggleAnia();
                setTimeout(() => { addMessage("Przenios≈Çam Ciƒô do formularza. Powodzenia! üòä", 'bot'); }, 500);
            } else if (opt.next) { loadScenario(opt.next); }
        }
        function showTypingIndicator() {
            const loader = document.createElement('div'); loader.id = 'typing-loader'; loader.className = 'msg bot';
            loader.style.color = '#aaa'; loader.innerText = '...';
            messagesArea.appendChild(loader); messagesArea.scrollTop = messagesArea.scrollHeight;
        }
        function removeTypingIndicator() { const loader = document.getElementById('typing-loader'); if(loader) loader.remove(); }
    </script>
</body>
</html>
